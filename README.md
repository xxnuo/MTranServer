# MTranServer

[English](README_en.md) | ä¸­æ–‡

<img src="./images/icon.png" width="64px" height="64px" align="right" alt="MTran">

ä¸€ä¸ªè¶…ä½èµ„æºæ¶ˆè€—è¶…å¿«çš„ç¦»çº¿ç¿»è¯‘æœåŠ¡å™¨ï¼Œæ— éœ€æ˜¾å¡ã€‚å•ä¸ªè¯·æ±‚å¹³å‡å“åº”æ—¶é—´ 50 æ¯«ç§’ã€‚æ”¯æŒå…¨ä¸–ç•Œä¸»è¦è¯­è¨€çš„ç¿»è¯‘ã€‚

ç¿»è¯‘è´¨é‡ä¸ Google ç¿»è¯‘ç›¸å½“ã€‚

> æ³¨æ„æœ¬æ¨¡å‹ä¸“æ³¨äºé€Ÿåº¦å’Œå¤šç§è®¾å¤‡ç§æœ‰éƒ¨ç½²ï¼Œæ‰€ä»¥ç¿»è¯‘è´¨é‡è‚¯å®šæ˜¯ä¸å¦‚å¤§æ¨¡å‹ç¿»è¯‘çš„æ•ˆæœã€‚éœ€è¦é«˜è´¨é‡çš„ç¿»è¯‘å»ºè®®ä½¿ç”¨åœ¨çº¿å¤§æ¨¡å‹ APIã€‚

## Demo

> å³å°†ä¸Šçº¿

<img src="./images/preview.png" width="auto" height="460">

## åŒç±»é¡¹ç›®æ•ˆæœ(CPU,è‹±è¯‘ä¸­)

| é¡¹ç›®åç§°                                                               | å†…å­˜å ç”¨ | å¹¶å‘æ€§èƒ½ | ç¿»è¯‘æ•ˆæœ | é€Ÿåº¦ | å…¶ä»–ä¿¡æ¯                                                                                                                          |
| ---------------------------------------------------------------------- | -------- | -------- | -------- | ---- | --------------------------------------------------------------------------------------------------------------------------------- |
| [facebook/nllb](https://github.com/facebookresearch/fairseq/tree/nllb) | å¾ˆé«˜     | å·®       | ä¸€èˆ¬     | æ…¢   | Android ç§»æ¤ç‰ˆçš„ [RTranslator](https://github.com/niedev/RTranslator) æœ‰å¾ˆå¤šä¼˜åŒ–ï¼Œä½†å ç”¨ä»ç„¶é«˜ï¼Œé€Ÿåº¦ä¹Ÿä¸å¿«                        |
| [LibreTranslate](https://github.com/LibreTranslate/LibreTranslate)     | å¾ˆé«˜     | ä¸€èˆ¬     | ä¸€èˆ¬     | ä¸­ç­‰ | ä¸­ç«¯ CPU æ¯ç§’å¤„ç† 3 å¥ï¼Œé«˜ç«¯ CPU æ¯ç§’å¤„ç† 15-20 å¥ã€‚[è¯¦æƒ…](https://community.libretranslate.com/t/performance-benchmark-data/486) |
| [OPUS-MT](https://github.com/OpenNMT/CTranslate2#benchmarks)           | é«˜       | ä¸€èˆ¬     | ç•¥å·®     | å¿«   | [æ€§èƒ½æµ‹è¯•](https://github.com/OpenNMT/CTranslate2#benchmarks)                                                                     |
| å…¶ä»–å¤§æ¨¡å‹                                                             | è¶…é«˜     | åŠ¨æ€     | å¥½å¥½å¥½   | å¾ˆæ…¢ | 32B åŠä»¥ä¸Šå‚æ•°çš„æ¨¡å‹æ•ˆæœä¸é”™ï¼Œä½†æ˜¯å¯¹ç¡¬ä»¶è¦æ±‚å¾ˆé«˜                                                                                  |
| MTranServer(æœ¬é¡¹ç›®)                                                    | ä½       | é«˜       | ä¸€èˆ¬     | æå¿« | å•ä¸ªè¯·æ±‚å¹³å‡å“åº”æ—¶é—´ 50ms, åŠ è½½è‹±è¯‘ä¸­æ¨¡å‹åå ç”¨çº¦ 450MB å†…å­˜                                                                      |

> ç°æœ‰çš„ Transformer æ¶æ„çš„å¤§æ¨¡å‹çš„å°å‚æ•°é‡åŒ–ç‰ˆæœ¬ä¸åœ¨è€ƒè™‘èŒƒå›´ã€‚
>
> å› ä¸ºå®é™…è°ƒç ”ä½¿ç”¨å‘ç°å°å‚æ•°æ¨¡å‹çš„ç¿»è¯‘è´¨é‡å¾ˆä¸ç¨³å®šä¸”ä¼šä¹±ç¿»ï¼Œå¹»è§‰ä¸¥é‡ï¼Œé€Ÿåº¦ä¹Ÿè¾¾ä¸åˆ°æŒ‡å“ªç¿»å“ªç§’å›çš„æ•ˆæœã€‚
> å‡ºäº†æ€§èƒ½æ›´ä¼˜çš„ Diffusion æ¶æ„çš„è¯­è¨€æ¨¡å‹ï¼Œå†æµ‹è¯•ã€‚
>
> è¡¨ä¸­æ•°æ®ä»…ä¾›å‚è€ƒï¼Œéä¸¥æ ¼æµ‹è¯•ï¼Œéé‡åŒ–ç‰ˆæœ¬å¯¹æ¯”ã€‚

## æ›´æ–°æ—¥å¿—

âš ï¸âš ï¸âš ï¸ æš‚æ—¶ä¸è¦æ›´æ–°ï¼Œbeta ç‰ˆæœ¬å­˜åœ¨å†…å­˜æ³„æ¼é—®é¢˜

âš ï¸âš ï¸âš ï¸ å»ºè®®ç›®å‰ç»§ç»­ä½¿ç”¨ 2.1.1

v3.0.1 å³å°†å‘å¸ƒ

- å®Œå…¨é‡å†™æœåŠ¡æ¶æ„ï¼Œæé«˜ç¨³å®šæ€§å’Œæ€§èƒ½
- æ·»åŠ  Swagger UI æ¥å£æ–‡æ¡£
- æ”¯æŒ HTTPS å®‰å…¨è¿æ¥
- æ·»åŠ æ¨¡å‹è‡ªåŠ¨ä¸‹è½½æœºåˆ¶ï¼Œä½¿ç”¨æ›´æµç•…
- æ”¯æŒæ›´å¤šè¯­è¨€å¯¹çš„ç¿»è¯‘
- æ›´æ–°æ¨¡å‹

## æ¡Œé¢ç«¯

å³å°†å‘å¸ƒæ¡Œé¢ç«¯è½¯ä»¶ï¼Œæ•¬è¯·æœŸå¾…ã€‚

## æœåŠ¡å™¨éƒ¨ç½²

> å¯¹æ™®é€šç”¨æˆ·æ¥è¯´æœ‰éš¾åº¦ï¼Œå»ºè®®ä½¿ç”¨æ¡Œé¢ç«¯ã€‚

### 1.1 ç¯å¢ƒè¦æ±‚

- Docker
- Docker Composeï¼ˆå¯é€‰ï¼‰

### 1.2 é•œåƒç‰ˆæœ¬

- é»˜è®¤æ— å†…ç½®æ¨¡å‹ç¿»è¯‘æ—¶è‡ªåŠ¨ä¸‹è½½ï¼š`xxnuo/mtranserver:latest`
- å†…ç½®ä¸­è‹±äº’è¯‘æ¨¡å‹ï¼š`xxnuo/mtranserver:latest-zh`
- å†…ç½®æ—¥è‹±äº’è¯‘æ¨¡å‹ï¼š`xxnuo/mtranserver:latest-ja`

### 1.3 Docker éƒ¨ç½²

å¤åˆ¶ä¸‹é¢çš„å‘½ä»¤ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œã€‚

```bash
docker run -d --name mtranserver -p 8989:8989 -e API_TOKEN=your_token xxnuo/mtranserver:latest
```

### 1.4 Docker Compose éƒ¨ç½²

æœåŠ¡å™¨å‡†å¤‡ä¸€ä¸ªå­˜æ”¾é…ç½®çš„æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤

```bash
mkdir mtranserver
cd mtranserver
touch compose.yml
```

ç”¨ç¼–è¾‘å™¨æ‰“å¼€ `compose.yml` æ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ã€‚

> 1. ä¿®æ”¹ä¸‹é¢çš„ `your_token` ä¸ºä½ è‡ªå·±è®¾ç½®çš„ä¸€ä¸ªå¯†ç ï¼Œä½¿ç”¨è‹±æ–‡å¤§å°å†™å’Œæ•°å­—ã€‚è‡ªå·±å†…ç½‘å¯ä»¥ä¸è®¾ç½®ï¼Œå¦‚æœæ˜¯`äº‘æœåŠ¡å™¨`å¼ºçƒˆå»ºè®®è®¾ç½®ä¸€ä¸ªå¯†ç ï¼Œä¿æŠ¤æœåŠ¡ä»¥å…è¢«`æ‰«åˆ°ã€æ”»å‡»ã€æ»¥ç”¨`ã€‚
>
> 2. å¦‚æœéœ€è¦æ›´æ”¹ç«¯å£ï¼Œä¿®æ”¹ `ports` çš„å€¼ï¼Œæ¯”å¦‚ä¿®æ”¹ä¸º `9999:8989` è¡¨ç¤ºå°†æœåŠ¡ç«¯å£æ˜ å°„åˆ°æœ¬æœº 9999 ç«¯å£ã€‚
>
> 3. å»ºè®®ä½¿ç”¨ `API_TOKEN` è®¾ç½®å¯†ç ï¼Œæ—§ç‰ˆæœ¬çš„ `CORE_API_TOKEN` ä¹Ÿè¿˜å¯ä»¥ç”Ÿæ•ˆã€‚

```yaml
services:
  mtranserver:
    image: xxnuo/mtranserver:latest
    container_name: mtranserver
    restart: unless-stopped
    ports:
      - "8989:8989"
    environment:
      - API_TOKEN=your_token
```

å…ˆå¯åŠ¨æµ‹è¯•ï¼Œç¡®ä¿ 8989 ç«¯å£æ²¡è¢«å ç”¨ã€‚

```bash
docker compose up
```

æ­£å¸¸è¾“å‡ºç¤ºä¾‹ï¼š

```bash
HTTP Service URL: http://0.0.0.0:8989
Swagger UI: http://0.0.0.0:8989/docs
```

ç„¶åæŒ‰ `Ctrl+C` åœæ­¢æœåŠ¡è¿è¡Œï¼Œç„¶åæ­£å¼å¯åŠ¨æœåŠ¡å™¨

```bash
docker compose up -d
```

è¿™æ—¶å€™æœåŠ¡å™¨å°±åœ¨åå°è¿è¡Œäº†ã€‚

## å‡†å¤‡æ¨¡å‹

âš ï¸ æ³¨æ„ï¼šç¬¬ä¸€æ¬¡è¯·æ±‚ç¿»è¯‘ API æ—¶ä¼šåœ¨åå°è‡ªåŠ¨ä¸‹è½½æ¨¡å‹ï¼Œæ— éœ€æ‰‹åŠ¨ä¸‹è½½ã€‚

æ¨¡å‹è‡ªåŠ¨ä¸‹è½½åŠŸèƒ½éœ€è¦è¿æ¥ç½‘ç»œï¼ˆä¸­å›½å¤§é™†ä¸éœ€è¦ä»£ç†ï¼‰ï¼Œ**åç»­ç¿»è¯‘åŠå…¶ä»–åŠŸèƒ½å‡æ— éœ€è”ç½‘å®Œå…¨ç¦»çº¿**ã€‚

**æ‰€ä»¥ç¬¬ä¸€æ¬¡ç¿»è¯‘ä¸æ˜¯ç§’å›ï¼Œè¦ç­‰å¾…ä¸€ä¼šå„¿ï¼**

å¯åœ¨ Docker æ—¥å¿—å¤„è§‚å¯Ÿè¿›åº¦ã€‚ä¸‹è½½é€Ÿåº¦å–å†³äºç½‘ç»œé€Ÿåº¦ï¼Œä¸€èˆ¬åœ¨ 10s å†…èƒ½å®Œæˆä¸€ä¸ªè¯­è¨€æ¨¡å‹çš„ä¸‹è½½ã€‚å¦‚æœä¸‹è½½è¶…æ—¶/å¤±è´¥ï¼Œè¯·æ£€æŸ¥å®¹å™¨æ˜¯å¦èƒ½æ­£å¸¸è”ç½‘ã€‚

å¦‚æœå±äºå†…ç½‘æœºå™¨æ— æ³•è®¿é—®äº’è”ç½‘å¯æŒ‰ç…§ä¸‹æ–‡æŒ‡å¯¼æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹ã€‚

### API ä½¿ç”¨

ä¸‹é¢è¡¨æ ¼å†…çš„ `localhost` å¯ä»¥æ›¿æ¢ä¸ºä½ çš„æœåŠ¡å™¨åœ°å€æˆ– Docker å®¹å™¨åã€‚

ä¸‹é¢è¡¨æ ¼å†…çš„ `8989` ç«¯å£å¯ä»¥æ›¿æ¢ä¸ºä½ åœ¨ `compose.yml` æ–‡ä»¶ä¸­è®¾ç½®çš„ç«¯å£å€¼ã€‚

å¦‚æœæœªè®¾ç½®ç¯å¢ƒå˜é‡ `API_TOKEN`ã€`CORE_API_TOKEN` æˆ–è€…è®¾ç½®ä¸ºç©ºï¼Œç¿»è¯‘æ’ä»¶ä½¿ç”¨`æ— å¯†ç `çš„ APIã€‚

å¦‚æœè®¾ç½®äº† `API_TOKEN`ã€`CORE_API_TOKEN`ï¼Œç¿»è¯‘æ’ä»¶ä½¿ç”¨`æœ‰å¯†ç `çš„ APIã€‚

ä¸‹é¢è¡¨æ ¼ä¸­çš„ `your_token` æ›¿æ¢ä¸ºä½ åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®çš„ `API_TOKEN` å€¼ã€‚

#### ç¿»è¯‘æ’ä»¶æ¥å£

> æ³¨ï¼š
>
> - [æ²‰æµ¸å¼ç¿»è¯‘](https://immersivetranslate.com/zh-Hans/docs/services/custom/) åœ¨`è®¾ç½®`é¡µé¢ï¼Œå¼€å‘è€…æ¨¡å¼ä¸­å¯ç”¨`Beta`ç‰¹æ€§ï¼Œå³å¯åœ¨`ç¿»è¯‘æœåŠ¡`ä¸­çœ‹åˆ°`è‡ªå®šä¹‰ API è®¾ç½®`([å®˜æ–¹å›¾æ–‡æ•™ç¨‹](https://immersivetranslate.com/zh-Hans/docs/services/custom/))ã€‚ç„¶åå°†`è‡ªå®šä¹‰ API è®¾ç½®`çš„`æ¯ç§’æœ€å¤§è¯·æ±‚æ•°`æ‹‰é«˜ä»¥å……åˆ†å‘æŒ¥æœåŠ¡å™¨æ€§èƒ½å‡†å¤‡ä½“éªŒé£ä¸€èˆ¬çš„æ„Ÿè§‰ã€‚æˆ‘è®¾ç½®çš„æ˜¯`æ¯ç§’æœ€å¤§è¯·æ±‚æ•°`ä¸º`5000`ï¼Œ`æ¯æ¬¡è¯·æ±‚æœ€å¤§æ®µè½æ•°`ä¸º`10`ã€‚ä½ å¯ä»¥æ ¹æ®è‡ªå·±æœåŠ¡å™¨é…ç½®è®¾ç½®ã€‚
>
> - [ç®€çº¦ç¿»è¯‘](https://github.com/fishjar/kiss-translator) åœ¨`è®¾ç½®`é¡µé¢ï¼Œæ¥å£è®¾ç½®ä¸­æ»šåŠ¨åˆ°ä¸‹é¢ï¼Œå³å¯çœ‹åˆ°è‡ªå®šä¹‰æ¥å£ `Custom`ã€‚åŒç†ï¼Œè®¾ç½®`æœ€å¤§è¯·æ±‚å¹¶å‘æ•°é‡`ã€`æ¯æ¬¡è¯·æ±‚é—´éš”æ—¶é—´`ä»¥å……åˆ†å‘æŒ¥æœåŠ¡å™¨æ€§èƒ½ã€‚æˆ‘è®¾ç½®çš„æ˜¯`æœ€å¤§è¯·æ±‚å¹¶å‘æ•°é‡`ä¸º`100`ï¼Œ`æ¯æ¬¡è¯·æ±‚é—´éš”æ—¶é—´`ä¸º`1`ã€‚ä½ å¯ä»¥æ ¹æ®è‡ªå·±æœåŠ¡å™¨é…ç½®è®¾ç½®ã€‚
>
> æ¥ä¸‹æ¥æŒ‰ä¸‹è¡¨çš„è®¾ç½®æ–¹æ³•è®¾ç½®æ’ä»¶çš„è‡ªå®šä¹‰æ¥å£åœ°å€ã€‚æ³¨æ„ç¬¬ä¸€æ¬¡è¯·æ±‚ä¼šæ…¢ä¸€äº›ï¼Œå› ä¸ºéœ€è¦åŠ è½½æ¨¡å‹ã€‚ä»¥åçš„è¯·æ±‚ä¼šå¾ˆå¿«ã€‚

| åç§°             | URL                                           | æ’ä»¶è®¾ç½®                                                                         |
| ---------------- | --------------------------------------------- | -------------------------------------------------------------------------------- |
| æ²‰æµ¸å¼ç¿»è¯‘æ— å¯†ç  | `http://localhost:8989/imme`                  | `è‡ªå®šä¹‰API è®¾ç½®` - `API URL`                                                     |
| æ²‰æµ¸å¼ç¿»è¯‘æœ‰å¯†ç  | `http://localhost:8989/imme?token=your_token` | åŒä¸Šï¼Œéœ€è¦æ›´æ”¹ URL å°¾éƒ¨çš„ `your_token` ä¸ºä½ çš„ `API_TOKEN` æˆ– `CORE_API_TOKEN` å€¼ |
| ç®€çº¦ç¿»è¯‘æ— å¯†ç    | `http://localhost:8989/kiss`                  | `æ¥å£è®¾ç½®` - `Custom` - `URL`                                                    |
| ç®€çº¦ç¿»è¯‘æœ‰å¯†ç    | `http://localhost:8989/kiss`                  | åŒä¸Šï¼Œéœ€è¦ `KEY` å¡« `your_token`                                                 |

**æ™®é€šç”¨æˆ·å‚ç…§è¡¨æ ¼å†…å®¹è®¾ç½®å¥½æ’ä»¶ä½¿ç”¨çš„æ¥å£åœ°å€å°±å¯ä»¥ä½¿ç”¨äº†ã€‚**

### ä¿æŒæ›´æ–°

```bash
cd mtranserver
docker pull xxnuo/mtranserver:latest
docker compose up -d
```

### å¼€å‘è€…æ¥å£

> Base URL: `http://localhost:8989`
>
> åœ¨ v3.0.0 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼ŒAPI æ–‡æ¡£å¯é€šè¿‡è®¿é—® `http://localhost:8989/docs` æŸ¥çœ‹å®Œæ•´ Swagger æ–‡æ¡£

| åç§°               | URL                      | è¯·æ±‚æ ¼å¼                                                                               | è¿”å›æ ¼å¼                                                           | è®¤è¯å¤´                    |
| ------------------ | ------------------------ | -------------------------------------------------------------------------------------- | ------------------------------------------------------------------ | ------------------------- |
| æœåŠ¡ç‰ˆæœ¬           | `/version`               | æ—                                                                                      | `{"version": "v3.0.0"}`                                            | æ—                         |
| æ”¯æŒçš„è¯­è¨€åˆ—è¡¨     | `/languages`             | æ—                                                                                      | `{"languages":["en","zh","ja","ko"...]}`                           | Authorization: your_token |
| æ™®é€šç¿»è¯‘æ¥å£       | `/translate`             | `{"from": "en", "to": "zh", "text": "Hello, world!"}`                                  | `{"result": "ä½ å¥½ï¼Œä¸–ç•Œï¼"}`                                       | Authorization: your_token |
| æ‰¹é‡ç¿»è¯‘æ¥å£       | `/translate/batch`       | `{"from": "en", "to": "zh", "texts": ["Hello, world!", "Hello, world!"]}`              | `{"results": ["ä½ å¥½ï¼Œä¸–ç•Œï¼", "ä½ å¥½ï¼Œä¸–ç•Œï¼"]}`                    | Authorization: your_token |
| å¥åº·æ£€æŸ¥           | `/health`                | æ—                                                                                      | `{"status": "ok"}`                                                 | æ—                         |
| å¿ƒè·³æ£€æŸ¥           | `/__heartbeat__`         | æ—                                                                                      | `Ready`                                                            | æ—                         |
| è´Ÿè½½å‡è¡¡å¿ƒè·³æ£€æŸ¥   | `/__lbheartbeat__`       | æ—                                                                                      | `Ready`                                                            | æ—                         |
| è°·æ­Œç¿»è¯‘å…¼å®¹æ¥å£ 1 | `/language/translate/v2` | `{"q": "The Great Pyramid of Giza", "source": "en", "target": "zh", "format": "text"}` | `{"data": {"translations": [{"translatedText": "å‰è¨å¤§é‡‘å­—å¡”"}]}}` | Authorization: your_token |

> å¼€å‘è€…é«˜çº§è®¾ç½®è¯·å‚è€ƒ [CONFIG.md](./CONFIG.md)

## èµåŠ©

[Buy me a coffee â˜•ï¸](https://www.creem.io/payment/prod_3QOnrHlGyrtTaKHsOw9Vs1)

[ä¸­å›½å¤§é™† ğŸ’— èµèµ](./DONATE.md)

## è´¡çŒ®è€…

<table>
  <tbody>
    <tr>
      <td align="center" valign="top" width="14.28%"><a href="https://github.com/Devillmy"><img src="https://avatars.githubusercontent.com/u/36851750?v=3?s=100" width="100px;" alt="Lv Meiyang"/><br /><sub><b>Lv Meiyang</b></sub></td>
      <td align="center" valign="top" width="14.28%"><a href="https://github.com/xxnuo"><img src="https://avatars.githubusercontent.com/u/54252779?v=3?s=100" width="100px;" alt="Leo"/><br /><sub><b>Leo</b></sub></td>
    </tr>
  </tbody>
</table>

## Star History

[![Star History Chart](https://api.star-history.com/svg?repos=xxnuo/MTranServer&type=Timeline)](https://www.star-history.com/#xxnuo/MTranServer&Timeline)
